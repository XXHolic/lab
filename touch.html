<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
  <title>touch hammer</title>
  <style type="text/css">
    * {margin: 0;}
    html,body{height: 100%;overflow-x: hidden;}
    .pop-box{
      display:-webkit-box;
      display: flex;
      -webkit-box-align: center;
      justify-content: center;
      -webkit-box-pack: center;
      align-items: center;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow-x: hidden;
      background-color: rgba(1, 1, 1, 1);
      /* -webkit-transition: transform 0.8s;
      transition: transform 0.8s; */
    }
    .box-move{
      width: 100px;
      height: 100px;
      background-color: #fff;
      -webkit-transition: transform 0.1s;
      transition: transform 0.1s;
    }
    .test{
      position: absolute;
      top:100px;
      left: 0;
      width:200px;
      background-color: #340;
    }
    .ani-tsf {
      -webkit-animation: downUp linear 1s infinite;
      animation: downUp linear 1s infinite;
    }
    @-webkit-keyframes downUp{
      50% {-webkit-transform: translateY(100px);transform: translateY(100px);}
      100% {
        -webkit-transform: translateY(0);transform: translateY(0);
      }
    }
    @keyframes downUp{
      50% {-webkit-transform: translateY(100px);transform: translateY(100px);}
      100% {
        -webkit-transform: translateY(0);transform: translateY(0);
      }
    }
    .ani-up {
      -webkit-animation: up linear 0.5s 1;
      animation: up linear 0.5s 1;
    }
    @-webkit-keyframes up{
      0% {-webkit-transform: translateX(0);transform: translateX(0);}    
      100% {
        -webkit-transform: translateX(-100%);transform: translateX(-100%);
      }
    }
    @keyframes up{
      0% {-webkit-transform: translateX(0);transform: translateX(0);} 
      100% {
        -webkit-transform: translateX(-100%);transform: translateX(-100%);
      }
    }
  </style>
</head>
<body>
<p>浮层滑动消失的效果</p>
<div class="test">transform在安卓中的效果</div>
<div class="pop-box" id="pop-box" style="display:none;">
  <div class="box-move" id="box-move"></div>
</div>
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/hammer.min.js"></script>
<script type="text/javascript">
  var popBox=document.getElementById("pop-box");
  var moveBox=document.getElementById("box-move");
  var mc=new Hammer(moveBox);
  mc.get("pan").set({direction: Hammer.DIRECTION_VERTICAL});
 
  mc.on("pan",function(e) {
    // console.log(e);
    var moveH=e.deltaX;
    var moveV=e.deltaY;
    // console.log(moveH);
    moveBox.style.WebkitTransform="translate("+moveH+"px,"+moveV+"px)";
    moveBox.style.Transform="translate("+moveH+"px,"+moveV+"px)";
    // moveBox.style.left=moveH+"px";
  })
  mc.on("panend",function(e) {
    var moveH=e.deltaX;
    var moveV=e.deltaY;
    var viewW=window.innerWidth;
    var viewH=window.innerHeight;
    // console.log(moveH);
    // console.log(moveV);
    var absMoveH=Math.abs(moveH);
    var absMoveV=Math.abs(moveV);
    var absSub=absMoveH-absMoveV;
    if(absMoveH>100 || absMoveV>100){
      if(moveH<0 && moveV<0){
        if(absSub>30){
          $("#pop-box").addClass("ani-up");
          // popBox.style.WebkitTransform="translate(-"+viewW+"px,0px)";
          // popBox.style.transform="translate(-"+viewW+"px,0px)";
        }
        if(absSub<-30){
          popBox.style.WebkitTransform="translate(0px,-"+viewH+"px)";
        }else{
          popBox.style.WebkitTransform="translate(-"+viewW+"px,-"+viewH+"px)";
        }
        
      }else if(moveH<0 && moveV>0){
        if(absSub>30){
          popBox.style.WebkitTransform="translate(-"+viewW+"px,0px)";
        }
        if(absSub<-30){
          popBox.style.WebkitTransform="translate(0px,"+viewH+"px)";
        }else{
          popBox.style.WebkitTransform="translate(-"+viewW+"px,"+viewH+"px)";
        }
        
      }else if(moveH>0 && moveV<0){
        if(absSub>30){
          popBox.style.WebkitTransform="translate("+viewW+"px,0px)";
        }
        if(absSub<-30){
          popBox.style.WebkitTransform="translate(0px,-"+viewH+"px)";
        }else{
          popBox.style.WebkitTransform="translate("+viewW+"px,-"+viewH+"px)";
        }
        
      }else if(moveH>0 && moveV>0){
        if(absSub>30){
          popBox.style.WebkitTransform="translate("+viewW+"px,0px)";
        }
        if(absSub<-30){
          popBox.style.WebkitTransform="translate(0px,"+viewH+"px)";
        }else{
          popBox.style.WebkitTransform="translate("+viewW+"px,"+viewH+"px)";
        }
        
      }
      // popBox.style.display="none";
      // $("#pop-box").hide();
      // console.log("popBox.style.display")
      // setTimeout(function(){
      //   popBox.style.display="none";
      // },1000);
    }else{
    moveBox.style.WebkitTransform="translate(0,0)";
    moveBox.style.Transform="translate(0,0)"  
    }
  })

  function showAgain() {
    popBox.style.WebkitTransform="translate(0,0)";
    popBox.style.display="flex";
    moveBox.style.WebkitTransform="translate(0,0)";
    moveBox.style.Transform="translate(0,0)"
  }
  // setTimeout(function() {
  //   showAgain();
  // },5000)
</script>
  
</body>
</html>